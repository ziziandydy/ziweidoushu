<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta name="robots" content="noindex, nofollow">
    <meta charset="UTF-8">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç´«å¾®æ–—æ•¸ API æ¸¬è©¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center">ç´«å¾®æ–—æ•¸ API åŠŸèƒ½æ¸¬è©¦</h1>

        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">æ¸¬è©¦è¼¸å…¥</h2>
            <div class="grid grid-cols-2 gap-4">
                <input id="test-name" class="p-2 border rounded" placeholder="å§“å" value="ç‹å°æ˜">
                <select id="test-gender" class="p-2 border rounded">
                    <option value="M">ç”·</option>
                    <option value="F">å¥³</option>
                </select>
                <input id="test-year" class="p-2 border rounded" placeholder="å‡ºç”Ÿå¹´" type="number" value="1990">
                <input id="test-month" class="p-2 border rounded" placeholder="å‡ºç”Ÿæœˆ" type="number" min="1" max="12"
                    value="5">
                <input id="test-day" class="p-2 border rounded" placeholder="å‡ºç”Ÿæ—¥" type="number" min="1" max="31"
                    value="15">
                <select id="test-hour" class="p-2 border rounded">
                    <option value="å­æ™‚">å­æ™‚</option>
                    <option value="ä¸‘æ™‚">ä¸‘æ™‚</option>
                    <option value="å¯…æ™‚">å¯…æ™‚</option>
                    <option value="å¯æ™‚">å¯æ™‚</option>
                    <option value="è¾°æ™‚">è¾°æ™‚</option>
                    <option value="å·³æ™‚">å·³æ™‚</option>
                    <option value="åˆæ™‚" selected>åˆæ™‚</option>
                    <option value="æœªæ™‚">æœªæ™‚</option>
                    <option value="ç”³æ™‚">ç”³æ™‚</option>
                    <option value="é…‰æ™‚">é…‰æ™‚</option>
                    <option value="æˆŒæ™‚">æˆŒæ™‚</option>
                    <option value="äº¥æ™‚">äº¥æ™‚</option>
                </select>
            </div>
            <div class="mt-4">
                <select id="test-calendar" class="p-2 border rounded">
                    <option value="lunar">è¾²æ›†</option>
                    <option value="solar" selected>è¥¿æ›†</option>
                </select>
                <label class="ml-2">
                    <input id="test-leap" type="checkbox" class="mr-1"> æ½¤æœˆ
                </label>
            </div>
            <button onclick="testCalculation()" class="mt-4 bg-blue-500 text-white px-6 py-2 rounded hover:bg-blue-600">
                æ¸¬è©¦è¨ˆç®—
            </button>
        </div>

        <div id="test-results" class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-xl font-semibold mb-4">æ¸¬è©¦çµæœ</h2>
            <div id="result-content" class="text-gray-500">é»æ“Šã€Œæ¸¬è©¦è¨ˆç®—ã€æŸ¥çœ‹çµæœ...</div>
        </div>
    </div>

    <script src="./api/destiny-calculator.js"></script>
    <script>
        function testCalculation() {
            const userInput = {
                name: document.getElementById('test-name').value,
                gender: document.getElementById('test-gender').value,
                birthYear: parseInt(document.getElementById('test-year').value),
                birthMonth: parseInt(document.getElementById('test-month').value),
                birthDay: parseInt(document.getElementById('test-day').value),
                birthHour: document.getElementById('test-hour').value,
                calendarType: document.getElementById('test-calendar').value,
                isLeapMonth: document.getElementById('test-leap').checked
            };

            const resultContent = document.getElementById('result-content');
            resultContent.innerHTML = '<div class="animate-spin inline-block w-4 h-4 border-2 border-blue-500 rounded-full"></div> è¨ˆç®—ä¸­...';

            setTimeout(() => {
                try {
                    if (typeof ZiweiCalculatorAPI !== 'undefined') {
                        const result = ZiweiCalculatorAPI.calculateDestiny(userInput);
                        displayResult(result);
                    } else {
                        resultContent.innerHTML = '<div class="text-red-500">âŒ ZiweiCalculatorAPI æœªè¼‰å…¥</div>';
                    }
                } catch (error) {
                    resultContent.innerHTML = `<div class="text-red-500">âŒ è¨ˆç®—éŒ¯èª¤: ${error.message}</div>`;
                }
            }, 1000);
        }

        function displayResult(result) {
            const resultContent = document.getElementById('result-content');

            if (result.success) {
                resultContent.innerHTML = `
                    <div class="space-y-4">
                        <div class="text-green-600 font-semibold">âœ… è¨ˆç®—æˆåŠŸï¼</div>
                        
                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-bold mb-2">ä½¿ç”¨è€…è³‡è¨Š</h3>
                            <p>å§“å: ${result.userInfo.name}</p>
                            <p>æ€§åˆ¥: ${result.userInfo.gender === 'M' ? 'ç”·' : 'å¥³'}</p>
                            <p>å‡ºç”Ÿ: ${result.userInfo.birthYear}å¹´${result.userInfo.birthMonth}æœˆ${result.userInfo.birthDay}æ—¥ ${result.userInfo.birthHour}</p>
                            <p>æ›†æ³•: ${result.userInfo.calendarType === 'lunar' ? 'è¾²æ›†' : 'è¥¿æ›†'}</p>
                        </div>

                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-bold mb-2">æ›†æ³•è³‡è¨Š</h3>
                            <p>è¥¿æ›†: ${result.calendarInfo.solar.year}/${result.calendarInfo.solar.month}/${result.calendarInfo.solar.day}</p>
                            <p>è¾²æ›†: ${result.calendarInfo.lunar.year}/${result.calendarInfo.lunar.month}/${result.calendarInfo.lunar.day} ${result.calendarInfo.lunar.isLeapMonth ? '(æ½¤æœˆ)' : ''}</p>
                        </div>

                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-bold mb-2">å‘½ç›¤è³‡è¨Š</h3>
                            <p>äº”è¡Œ: ${result.destinyInfo.element}</p>
                            <p>å‘½ä¸»æ˜Ÿ: ${result.destinyInfo.destinyMaster.name} (èƒ½é‡: ${result.destinyInfo.destinyMaster.energyLevel})</p>
                            <p>èº«ä¸»æ˜Ÿ: ${result.destinyInfo.bodyMaster.name} (èƒ½é‡: ${result.destinyInfo.bodyMaster.energyLevel})</p>
                        </div>

                        <div class="bg-gray-50 p-4 rounded">
                            <h3 class="font-bold mb-2">åäºŒå®®é…ç½®</h3>
                            <div class="grid grid-cols-2 gap-2">
                                ${result.destinyInfo.palaces.map(palace =>
                    `<div class="text-sm">
                                        <strong>${palace.palaceName}:</strong> 
                                        ${palace.majorStars.map(star =>
                        `${star.name}(${star.energyLevel})`
                    ).join(', ') || 'ç„¡ä¸»æ˜Ÿ'}
                                     </div>`
                ).join('')}
                            </div>
                        </div>

                        <div class="text-green-600 text-sm">
                            ğŸ‰ API æ•´åˆæˆåŠŸï¼æ‰€æœ‰åŠŸèƒ½æ­£å¸¸é‹ä½œã€‚
                        </div>
                    </div>
                `;
            } else {
                resultContent.innerHTML = `
                    <div class="text-red-500">
                        <strong>âŒ è¨ˆç®—å¤±æ•—:</strong> ${result.error}
                    </div>
                `;
            }
        }

        // æª¢æŸ¥ API è¼‰å…¥ç‹€æ…‹
        window.addEventListener('load', () => {
            if (typeof ZiweiCalculatorAPI !== 'undefined') {
                console.log('âœ… ZiweiCalculatorAPI è¼‰å…¥æˆåŠŸ');
            } else {
                console.error('âŒ ZiweiCalculatorAPI è¼‰å…¥å¤±æ•—');
            }
        });
    </script>
</body>

</html>
